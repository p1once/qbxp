import{importShared as P}from"./__federation_fn_import-Coq5AEjh.js";import{r as I}from"./index-CtmpQeow.js";var S={exports:{}},g={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R=I,C=Symbol.for("react.element"),T=Symbol.for("react.fragment"),z=Object.prototype.hasOwnProperty,O=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,o){var r,c={},i=null,p=null;o!==void 0&&(i=""+o),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(p=t.ref);for(r in t)z.call(t,r)&&!A.hasOwnProperty(r)&&(c[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)c[r]===void 0&&(c[r]=t[r]);return{$$typeof:C,type:e,key:i,ref:p,props:c,_owner:O.current}}g.Fragment=T;g.jsx=j;g.jsxs=j;S.exports=g;var a=S.exports;const y={en:{title:"GPS Trackers",searchPlaceholder:"Search plate...",refresh:"Refresh",empty:"No trackers installed.",ping:"Ping",installedTemplate:"Installed {relative} ago",live:"Live",stale:"Out of range",errorLoading:"Unable to load trackers. Please try again.",loading:"Loading...",relative:{seconds:"s",minutes:"m",hours:"h",days:"d"}},fr:{title:"Traqueurs GPS",searchPlaceholder:"Rechercher une plaque...",refresh:"Rafraichir",empty:"Aucun traqueur installe.",ping:"Pinger",installedTemplate:"Installe il y a {relative}",live:"Actif",stale:"Hors portee",errorLoading:"Impossible de charger la liste des traqueurs.",loading:"Chargement...",relative:{seconds:"s",minutes:"m",hours:"h",days:"j"}}},D=e=>e.trim().toLowerCase(),$=()=>{const e=y.en,t=window.__NPWD_LANG__??(navigator.language||"en"),o=D(t).split("-")[0];return y[o]??e},q="npwd_qbx_trackers",M=()=>typeof window<"u"&&!("invokeNative"in window);async function k(e,t,o){if(M())return console.info(`[fetchNui:${e}]`,t),o!==void 0?o:Promise.resolve({});const r=await fetch(`https://${q}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t??{})});if(!r.ok)throw new Error(`NUI callback ${e} responded with ${r.status}`);return await r.json()}const b=60,m=60*b,v=24*m,W=(e,t)=>{if(!e||Number.isNaN(e))return"-";const o=Math.floor(Date.now()/1e3),r=Math.max(0,o-Math.floor(e));return r<b?`${r}${t.relative.seconds}`:r<m?`${Math.floor(r/b)}${t.relative.minutes}`:r<v?`${Math.floor(r/m)}${t.relative.hours}`:`${Math.floor(r/v)}${t.relative.days}`},{useCallback:E,useEffect:_,useMemo:N,useState:f}=await P("react"),U=[{plate:"DEV123",installedAt:Math.floor(Date.now()/1e3)-140,net:!0},{plate:"NPWD42",installedAt:Math.floor(Date.now()/1e3)-3600,net:!1}],w="{relative}",B={glass:"linear-gradient(145deg, rgba(18, 24, 38, 0.92), rgba(12, 16, 28, 0.85))"},s={app:{display:"flex",flexDirection:"column",height:"100%",width:"100%",padding:"20px 18px",color:"#edf2ff",fontFamily:'"Segoe UI", system-ui, -apple-system, sans-serif',background:"radial-gradient(130% 120% at 10% 0%, rgba(102,209,255,0.25), rgba(12,15,20,0.92)), radial-gradient(110% 100% at 100% 100%, rgba(37,132,247,0.18), rgba(12,15,20,0.9))",backdropFilter:"blur(8px)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"14px",marginBottom:"18px",borderBottom:"1px solid rgba(255,255,255,0.08)",paddingBottom:"14px"},title:{margin:0,fontSize:"19px",fontWeight:700,letterSpacing:"0.6px"},subtitle:{margin:0,fontSize:"12px",color:"#9fb2cc",opacity:.9},tools:{display:"flex",alignItems:"center",gap:"10px",flex:1},search:{flex:1,padding:"11px 14px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.14)",background:"rgba(12, 19, 30, 0.88)",color:"inherit",fontSize:"14px"},refresh:{padding:"11px 16px",borderRadius:"12px",border:"1px solid rgba(102,209,255,0.35)",background:"transparent",color:"#d8f2ff",fontWeight:600,fontSize:"14px",cursor:"pointer"},body:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"stretch",gap:"10px",paddingRight:"2px"},card:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",padding:"12px 14px",borderRadius:"14px",background:B.glass,border:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 12px 28px rgba(9,17,31,0.30)",minHeight:"74px",width:"100%"},cardMeta:{display:"flex",flexDirection:"column",gap:"4px"},cardPlate:{fontSize:"16px",fontWeight:700,letterSpacing:"0.8px"},cardSub:{fontSize:"11px",color:"#9fb2cc"},badgeLive:{padding:"5px 10px",borderRadius:"999px",background:"rgba(30, 178, 120, 0.22)",color:"#8effc7",fontWeight:600,fontSize:"12px"},badgeStale:{padding:"5px 10px",borderRadius:"999px",background:"rgba(214, 139, 34, 0.2)",color:"#f7d09b",fontWeight:600,fontSize:"12px"},actions:{display:"flex",alignItems:"center",gap:"8px"},button:{padding:"9px 14px",borderRadius:"11px",border:"none",fontWeight:600,fontSize:"13px",background:"linear-gradient(135deg, #66d1ff, #2a9df4)",color:"#082b42",cursor:"pointer",transition:"transform 0.1s ease, filter 0.15s ease"},empty:{textAlign:"center",marginTop:"40px",color:"#9fb2cc",fontSize:"14px"},status:{fontSize:"13px",color:"#9fb2cc"},error:{background:"rgba(200,40,40,0.18)",border:"1px solid rgba(200,40,40,0.38)",color:"#ffe4e4",padding:"12px 14px",borderRadius:"12px",fontSize:"13px"}},F=()=>{const e=N(()=>$(),[]),[t,o]=f(""),[r,c]=f([]),[i,p]=f(!1),[x,n]=f(null),d=E(async()=>{p(!0),n(null);try{const l=await k("npwd:qbx_trackers:list",void 0,{status:"ok",data:U}),u=Array.isArray(l)?l:l?.data??[];c(u)}catch(l){console.error("Failed to fetch tracker list",l),n(e.errorLoading)}finally{p(!1)}},[e.errorLoading]);_(()=>{d()},[d]),_(()=>{const l=u=>{u.data?.action==="npwd:visibility"&&u.data.visibility&&d()};return window.addEventListener("message",l),()=>window.removeEventListener("message",l)},[d]);const h=N(()=>{const l=t.trim().toUpperCase();return l?r.filter(u=>u.plate?.toUpperCase().includes(l)):r},[r,t]);return{locale:e,query:t,setQuery:o,entries:h,refresh:d,loading:i,error:x}},H=(e,t)=>e.includes(w)?e.replace(w,t):e,J=()=>{const{locale:e,query:t,setQuery:o,entries:r,refresh:c,loading:i,error:p}=F(),x=E(async n=>{if(n)try{await k("npwd:qbx_trackers:requestWaypoint",{plate:n})}catch(d){console.error("Failed to ping tracker",d)}},[]);return a.jsxs("div",{style:s.app,className:"app trackers-app",children:[a.jsxs("header",{style:s.header,className:"app__header",children:[a.jsxs("div",{children:[a.jsx("h1",{style:s.title,className:"app__title",children:e.title}),a.jsx("p",{style:s.subtitle,children:"Suivez vos traqueurs en temps réel et posez un ping instantané."})]}),a.jsxs("div",{style:s.tools,className:"app__tools",children:[a.jsx("input",{style:s.search,className:"app__search",value:t,onChange:n=>o(n.target.value),placeholder:e.searchPlaceholder}),a.jsx("button",{style:{...s.refresh,opacity:i?.6:1},className:"button button--ghost",onClick:c,disabled:i,children:e.refresh})]})]}),p&&a.jsx("div",{style:s.error,className:"error",children:p}),i&&a.jsx("div",{style:s.status,className:"status",children:e.loading}),a.jsxs("div",{style:s.body,className:"content",children:[!r.length&&!i&&a.jsx("div",{style:s.empty,className:"empty",children:e.empty}),r.map(n=>{const d=W(n.installedAt,e),h=H(e.installedTemplate,d);return a.jsxs("article",{style:s.card,className:"card",children:[a.jsxs("div",{style:s.cardMeta,className:"card__meta",children:[a.jsx("div",{style:s.cardPlate,className:"card__plate",children:n.plate}),a.jsx("div",{style:s.cardSub,className:"card__sub",children:h})]}),a.jsxs("div",{style:s.actions,className:"card__actions",children:[a.jsx("span",{style:n.net?s.badgeLive:s.badgeStale,className:`badge ${n.net?"badge--live":"badge--stale"}`,children:n.net?e.live:e.stale}),a.jsx("button",{style:s.button,className:"button",onClick:()=>x(n.plate),children:e.ping})]})]},n.plate)})]})]})},L=({fontSize:e="large"})=>{const t=e==="large"?32:24;return a.jsx("svg",{viewBox:"0 0 24 24",width:t,height:t,fill:"currentColor",children:a.jsx("path",{d:"M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6.5a2.5 2.5 0 0 1 0 5z"})})},Q=e=>a.jsx(L,{...e}),K=e=>a.jsx(L,{...e});export{Q as A,K as N,J as T,M as i,a as j};
