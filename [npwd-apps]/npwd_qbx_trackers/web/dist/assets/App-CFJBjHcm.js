import{importShared as $}from"./__federation_fn_import-Coq5AEjh.js";import{r as q}from"./index-CtmpQeow.js";var O={exports:{}},m={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M=q,W=Symbol.for("react.element"),U=Symbol.for("react.fragment"),B=Object.prototype.hasOwnProperty,F=M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,n){var r,o={},i=null,p=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(p=t.ref);for(r in t)B.call(t,r)&&!V.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:W,type:e,key:i,ref:p,props:o,_owner:F.current}}m.Fragment=U;m.jsx=A;m.jsxs=A;O.exports=m;var a=O.exports;const E={en:{title:"GPS Trackers",searchPlaceholder:"Search plate...",refresh:"Refresh",empty:"No trackers installed.",ping:"Ping",installedTemplate:"Installed {relative} ago",live:"Live",stale:"Out of range",errorLoading:"Unable to load trackers. Please try again.",loading:"Loading...",relative:{seconds:"s",minutes:"m",hours:"h",days:"d"}},fr:{title:"Traqueurs GPS",searchPlaceholder:"Rechercher une plaque...",refresh:"Rafraichir",empty:"Aucun traqueur installe.",ping:"Pinger",installedTemplate:"Installe il y a {relative}",live:"Actif",stale:"Hors portee",errorLoading:"Impossible de charger la liste des traqueurs.",loading:"Chargement...",relative:{seconds:"s",minutes:"m",hours:"h",days:"j"}}},G=e=>e.trim().toLowerCase(),H=()=>{const e=E.en,t=window.__NPWD_LANG__??(navigator.language||"en"),n=G(t).split("-")[0];return E[n]??e},J="npwd_qbx_trackers",Y=()=>typeof window<"u"&&!("invokeNative"in window);async function P(e,t,n){if(Y())return console.info(`[fetchNui:${e}]`,t),n!==void 0?n:Promise.resolve({});const r=await fetch(`https://${J}/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t??{})});if(!r.ok)throw new Error(`NUI callback ${e} responded with ${r.status}`);return await r.json()}const k=60,j=60*k,L=24*j,K=(e,t)=>{if(!e||Number.isNaN(e))return"-";const n=Math.floor(Date.now()/1e3),r=Math.max(0,n-Math.floor(e));return r<k?`${r}${t.relative.seconds}`:r<j?`${Math.floor(r/k)}${t.relative.minutes}`:r<L?`${Math.floor(r/j)}${t.relative.hours}`:`${Math.floor(r/L)}${t.relative.days}`},{useCallback:C,useEffect:b,useMemo:N,useRef:Q,useState:u}=await $("react");let I=null;const R="npwd_qbx_trackers_cache_v1",X=[{plate:"DEV123",installedAt:Math.floor(Date.now()/1e3)-140,net:!0},{plate:"NPWD42",installedAt:Math.floor(Date.now()/1e3)-3600,net:!1}],T="{relative}",Z={glass:"linear-gradient(145deg, rgba(18, 24, 38, 0.92), rgba(12, 16, 28, 0.85))"},s={app:{display:"flex",flexDirection:"column",height:"100%",width:"100%",padding:"20px 18px",color:"#edf2ff",fontFamily:'"Segoe UI", system-ui, -apple-system, sans-serif',background:"radial-gradient(130% 120% at 10% 0%, rgba(102,209,255,0.25), rgba(12,15,20,0.92)), radial-gradient(110% 100% at 100% 100%, rgba(37,132,247,0.18), rgba(12,15,20,0.9))",backdropFilter:"blur(8px)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"14px",marginBottom:"18px",borderBottom:"1px solid rgba(255,255,255,0.08)",paddingBottom:"14px"},title:{margin:0,fontSize:"19px",fontWeight:700,letterSpacing:"0.6px"},subtitle:{margin:0,fontSize:"12px",color:"#9fb2cc",opacity:.9},tools:{display:"flex",alignItems:"center",gap:"10px",flex:1},search:{flex:1,padding:"11px 14px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.14)",background:"rgba(12, 19, 30, 0.88)",color:"inherit",fontSize:"14px"},refresh:{padding:"11px 16px",borderRadius:"12px",border:"1px solid rgba(102,209,255,0.35)",background:"transparent",color:"#d8f2ff",fontWeight:600,fontSize:"14px",cursor:"pointer"},body:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"stretch",gap:"10px",paddingRight:"2px"},card:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",padding:"12px 14px",borderRadius:"14px",background:Z.glass,border:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 12px 28px rgba(9,17,31,0.30)",minHeight:"74px",width:"100%"},cardMeta:{display:"flex",flexDirection:"column",gap:"4px"},cardPlate:{fontSize:"16px",fontWeight:700,letterSpacing:"0.8px"},cardSub:{fontSize:"11px",color:"#9fb2cc"},badgeLive:{padding:"5px 10px",borderRadius:"999px",background:"rgba(30, 178, 120, 0.22)",color:"#8effc7",fontWeight:600,fontSize:"12px"},badgeStale:{padding:"5px 10px",borderRadius:"999px",background:"rgba(214, 139, 34, 0.2)",color:"#f7d09b",fontWeight:600,fontSize:"12px"},actions:{display:"flex",alignItems:"center",gap:"8px"},button:{padding:"9px 14px",borderRadius:"11px",border:"none",fontWeight:600,fontSize:"13px",background:"linear-gradient(135deg, #66d1ff, #2a9df4)",color:"#082b42",cursor:"pointer",transition:"transform 0.1s ease, filter 0.15s ease"},empty:{textAlign:"center",marginTop:"40px",color:"#9fb2cc",fontSize:"14px"},status:{fontSize:"13px",color:"#9fb2cc"},error:{background:"rgba(200,40,40,0.18)",border:"1px solid rgba(200,40,40,0.38)",color:"#ffe4e4",padding:"12px 14px",borderRadius:"12px",fontSize:"13px"}},ee=(e,t=120)=>{const[n,r]=u(!1);return b(()=>{let o;return e?o=window.setTimeout(()=>r(!0),t):r(!1),()=>{o!==void 0&&window.clearTimeout(o)}},[e,t]),n},te=()=>{const e=N(()=>H(),[]),[t,n]=u(""),r=N(()=>{try{const c=localStorage.getItem(R);if(c){const d=JSON.parse(c);if(Array.isArray(d))return d}}catch{}return I?.entries??[]},[]),o=r.length>0,[i,p]=u(r),[y,h]=u(()=>!o),[v,x]=u(null),[w,l]=u(()=>o),[f,_]=u(()=>o),S=Q(!0),g=C(async()=>{h(!0),x(null);try{const c=await P("npwd:qbx_trackers:list",void 0,{status:"ok",data:X}),d=Array.isArray(c)?c:c?.data;if(!Array.isArray(d))throw new Error("Invalid tracker list payload");p(d),I={entries:d};try{localStorage.setItem(R,JSON.stringify(d))}catch{}d.length>0&&l(!0),_(!0)}catch(c){console.error("Failed to fetch tracker list",c),x(e.errorLoading)}finally{h(!1)}},[e.errorLoading]);b(()=>{g()},[g]),b(()=>{const c=d=>{if(d.data?.action==="npwd:visibility")if(d.data.visibility){if(S.current){S.current=!1;return}g()}else S.current=!1};return window.addEventListener("message",c),()=>window.removeEventListener("message",c)},[g]);const D=N(()=>{const c=t.trim().toUpperCase();return c?i.filter(d=>d.plate?.toUpperCase().includes(c)):i},[i,t]);return{locale:e,query:t,setQuery:n,entries:D,refresh:g,loading:y,error:v,loadedOnce:w,ready:f}},re=(e,t)=>e.includes(T)?e.replace(T,t):e,ae=(e,t=220)=>{const[n,r]=u(!1);return b(()=>{if(!e){r(!1);return}const o=window.setTimeout(()=>r(!0),t);return()=>window.clearTimeout(o)},[t,e]),n},oe=()=>{const{locale:e,query:t,setQuery:n,entries:r,refresh:o,loading:i,error:p,ready:y}=te(),h=ee(i),v=y&&!i&&r.length===0&&!p,x=ae(v),w=C(async l=>{if(l)try{await P("npwd:qbx_trackers:requestWaypoint",{plate:l})}catch(f){console.error("Failed to ping tracker",f)}},[]);return a.jsxs("div",{style:s.app,className:"app trackers-app",children:[a.jsxs("header",{style:s.header,className:"app__header",children:[a.jsxs("div",{children:[a.jsx("h1",{style:s.title,className:"app__title",children:e.title}),a.jsx("p",{style:s.subtitle,children:"Suivez vos traqueurs en temps réel et posez un ping instantané."})]}),a.jsxs("div",{style:s.tools,className:"app__tools",children:[a.jsx("input",{style:s.search,className:"app__search",value:t,onChange:l=>n(l.target.value),placeholder:e.searchPlaceholder}),a.jsx("button",{style:{...s.refresh,opacity:i?.6:1},className:"button button--ghost",onClick:o,disabled:i,children:e.refresh})]})]}),p&&a.jsx("div",{style:s.error,className:"error",children:p}),h&&a.jsx("div",{style:s.status,className:"status",children:e.loading}),a.jsxs("div",{style:s.body,className:"content",children:[x&&a.jsx("div",{style:s.empty,className:"empty",children:e.empty}),r.map(l=>{const f=K(l.installedAt,e),_=re(e.installedTemplate,f);return a.jsxs("article",{style:s.card,className:"card",children:[a.jsxs("div",{style:s.cardMeta,className:"card__meta",children:[a.jsx("div",{style:s.cardPlate,className:"card__plate",children:l.plate}),a.jsx("div",{style:s.cardSub,className:"card__sub",children:_})]}),a.jsxs("div",{style:s.actions,className:"card__actions",children:[a.jsx("span",{style:l.net?s.badgeLive:s.badgeStale,className:`badge ${l.net?"badge--live":"badge--stale"}`,children:l.net?e.live:e.stale}),a.jsx("button",{style:s.button,className:"button",onClick:()=>w(l.plate),children:e.ping})]})]},l.plate)})]})]})},z=({fontSize:e="large"})=>{const t=e==="large"?32:24;return a.jsx("svg",{viewBox:"0 0 24 24",width:t,height:t,fill:"currentColor",children:a.jsx("path",{d:"M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7zm0 9.5A2.5 2.5 0 1 1 12 6.5a2.5 2.5 0 0 1 0 5z"})})},ie=e=>a.jsx(z,{...e}),le=e=>a.jsx(z,{...e});export{ie as A,le as N,oe as T,Y as i,a as j};
